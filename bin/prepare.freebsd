#!/bin/sh

command -v freebsd-version >/dev/null
if [ $? -gt 0 ]; then
    echo "This script only support FreeBSD"
    exit 1
fi

user=_www
group=_www
nginx_conf="/usr/local/etc/nginx/vhosts/${server_name}"
uwsgi_conf="/usr/local/etc/uwsgi/vassals/${server_name}.ini"

#
# Prepare the system
#
_prerequisites() {
    freebsd-update fetch install
    pkg install \
        py36-pip py36-psycopg2 nginx py27-certbot postgresql10-server uwsgi
    rehash
}


#
# Startup
#
_startup() {
    sysrc uwsgi_emperor=YES
    for service in postgresql uwsgi nginx; do
    	sysrc ${service}_enable=YES
    	service ${service} restart
    done
}

_stop_nginx() {
    service nginx stop
}


#
# Prepare
#

_prerequisites
